This code is Lisensed to Hao Xu in the College of William and Mary
